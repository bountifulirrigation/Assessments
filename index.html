<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Assessment History</title>
<style>
  :root {
    --brand: #2A6F97;
    --bg: #f8fafc;
    --text: #111827;
    --muted: #6b7280;
    --card: #ffffff;
    --border: #e5e7eb;
    --focus: #0ea5e9;
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --bg: #0b1220;
      --text: #e5e7eb;
      --muted: #9aa4af;
      --card: #0f172a;
      --border: #1f2937;
      --focus: #38bdf8;
    }
  }
  html, body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: var(--bg); color: var(--text); }
  header { padding: 1rem 1.25rem; background: var(--card); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 10; }
  h1 { margin: 0 0 .25rem 0; font-size: 1.25rem; }
  .sub { color: var(--muted); font-size: .9rem; }
  .wrap { display: grid; gap: 1rem; grid-template-columns: 1fr; padding: 1rem; max-width: 1200px; margin: 0 auto; }
  @media (min-width: 980px) { .wrap { grid-template-columns: 420px 1fr; } }

  .panel { background: var(--card); border: 1px solid var(--border); border-radius: .75rem; padding: 1rem; box-shadow: 0 1px 2px rgba(0,0,0,0.03); }

  .grid-2 { display: grid; grid-template-columns: 1fr; gap: .75rem; }
  @media (min-width: 600px) { .grid-2 { grid-template-columns: 1fr 1fr; } }

  label { font-size: .85rem; color: var(--muted); margin-bottom: .25rem; display: block; }
  .input {
    display: flex; gap: .5rem; align-items: center;
    border: 1px solid var(--border); border-radius: .5rem; padding: .5rem .75rem; background: #fff;
  }
  @media (prefers-color-scheme: dark) { .input { background: #111827; } }
  .input input {
    width: 100%; border: none; outline: none; font-size: 1rem; background: transparent; color: inherit;
  }
  .btn { border: 1px solid var(--border); background: #fff; border-radius: .5rem; padding: .5rem .75rem; cursor: pointer; color: inherit; }
  .btn:hover { border-color: var(--brand); }
  .count { font-size: .9rem; color: var(--muted); margin-top: .5rem; }

  .results { list-style: none; margin: 0; padding: 0; }
  .result-item {
    padding: .75rem; border: 1px solid var(--border); border-radius: .5rem; margin-bottom: .5rem; background: #fff; cursor: pointer;
  }
  @media (prefers-color-scheme: dark) { .result-item { background: #0b1220; } }
  .result-item:hover { border-color: var(--brand); }
  .result-main { font-weight: 600; }
  .result-sub { color: var(--muted); font-size: .9rem; }

  .detail-title { font-weight: 700; margin: 0 0 .5rem 0; }
  dl { display: grid; grid-template-columns: minmax(160px, 240px) 1fr; gap: .5rem 1rem; margin: 0; }
  dt { color: var(--muted); }
  dd { margin: 0; }
  .empty { color: var(--muted); font-style: italic; }
  .pill { display:inline-block; background: #eff6ff; color:#1d4ed8; border:1px solid #bfdbfe; padding:.15rem .4rem; border-radius: .375rem; font-size: .8rem; }
  .highlight { background: #fff3b0; }
  .footer { color: var(--muted); font-size: .85rem; padding: 1rem; text-align: center; }
  .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }
  :focus-visible { outline: 2px solid var(--focus); outline-offset: 2px; }
</style>
</head>
<body>
<header>
  <h1 id="title">Assessment History</h1>
  <div class="sub">Search by Tax Serial or Address, then select a record to view full details.</div>
</header>

<main class="wrap">
<section class="panel">
  <div class="grid-2">
    <div>
      <label for="taxSearch">Tax Serial</label>
      <div class="input">
        <input id="taxSearch" type="search" />
        <button class="btn" id="clearTax" type="button">✕</button>
      </div>
    </div>
    <div>
      <label for="addrSearch">Address</label>
      <div class="input">
        <input id="addrSearch" type="search" />
        <button class="btn" id="clearAddr" type="button">✕</button>
      </div>
    </div>
  </div>
  <div class="count" id="resultCount">Loading data…</div>
  <ul class="results" id="results"></ul>
</section>

<aside class="panel">
  <h2 class="detail-title">Details</h2>
  <div id="details" class="empty">Select a record to view its details.</div>
</aside>
</main>

<footer class="footer">Static site · No login · No cookies</footer>

<script>
const KEY_TAX = 'taxSerNo';
const KEY_ADDR = 'addressComb';
let DATA = [];

const escapeHTML = (s) =>
  String(s).replace(/[&<>"']/g, m => ({
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;'
  }[m]));

function render(rows) {
  const ul = document.getElementById('results');
  ul.innerHTML = '';
  rows.forEach(r => {
    const li = document.createElement('li');
    li.className = 'result-item';
    li.textContent = (r[KEY_TAX] || '') + ' — ' + (r[KEY_ADDR] || '');
    li.onclick = () => {
      document.getElementById('details').innerHTML =
        '<pre>' + escapeHTML(JSON.stringify(r, null, 2)) + '</pre>';
    };
    ul.appendChild(li);
  });
  document.getElementById('resultCount').textContent =
    rows.length + ' result' + (rows.length === 1 ? '' : 's');
}

function filter() {
  const t = taxSearch.value.toLowerCase();
  const a = addrSearch.value.toLowerCase();
  render(DATA.filter(r =>
    (!t || String(r[KEY_TAX]||'').toLowerCase().includes(t)) &&
    (!a || String(r[KEY_ADDR]||'').toLowerCase().includes(a))
  ));
}

fetch('data.json')
  .then(r => r.json())
  .then(j => { DATA = j; filter(); });

taxSearch.oninput = addrSearch.oninput = filter;
clearTax.onclick = () => { taxSearch.value=''; filter(); };
clearAddr.onclick = () => { addrSearch.value=''; filter(); };
</script>
</body>
</html>
